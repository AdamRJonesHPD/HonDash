import datetime

class Odometer:

	def __init__(self):
		self.lastTime = datetime.datetime.now()
		self.lastSpeed = 0
		

	def getValue(self,speed):
	    try:
		now = datetime.datetime.now()
		diff = (now-self.lastTime).microseconds + (now-self.lastTime).seconds*1000000
		kmTraveled = (speed/3600000000.0)*diff
		self.lastTime = now
		self.lastSpeed = speed

		with open('mileage', 'r+') as f:
			total = float(f.readline())
			f.seek(0) 
			f.truncate()
			f.write(str(total+kmTraveled))
		
		return int(total+kmTraveled)
	    except:
		with open('mileage', 'r+') as f:
                        f.seek(0)
                        f.truncate()
                        f.write("43")
